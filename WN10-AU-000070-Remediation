<#
.SYNOPSIS
    Configures Advanced Audit Policy for Logon failures on a standalone machine.
.DESCRIPTION
    Enables: Computer Configuration → Windows Settings → Security Settings → 
              Advanced Audit Policy Configuration → System Audit Policies → Logon/Logoff → Audit Logon (Failure).
#>

.NOTES
    Author          : Zachary Moses
    LinkedIn        : https://www.linkedin.com/in/zach-moses-a3722a212/
    GitHub          : https://github.com/users/zacharytmoses-cyber
    Date Created    : 2025-09-27
    Last Modified   : 2025-09-27
    Version         : 1.0
    CVEs            : N/A
    Plugin IDs      : N/A
    STIG-ID         : WN10-AU000070

.TESTED ON
    Date(s) Tested  : 2025-09-27
    Tested By       : Zachary Moses
    Systems Tested  : Windows 10 Pro 10.0.19045 Build 19045
    PowerShell Ver. : 5.1.19041.6328

.USAGE

Please run this as administrator after testing in isolated sandbox vm prior to any production systems. Run this in Windows Powershell. 
# Ensure script runs as Administrator
If (-NOT ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator"))
{
    Write-Error "You must run this script as Administrator!"
    exit 1
}

$subcategory = "Logon"

Write-Host "Checking current Audit Policy for '$subcategory'..." -ForegroundColor Cyan
auditpol /get /subcategory:"$subcategory"

Write-Host "Enabling auditing for Logon Failures..." -ForegroundColor Yellow
auditpol /set /subcategory:"$subcategory" /success:disable /failure:enable

Write-Host "Verifying changes..." -ForegroundColor Cyan
auditpol /get /subcategory:"$subcategory"
